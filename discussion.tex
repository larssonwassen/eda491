\section{Discussion} 
\label{sec:discussion}

The firewall configuration made is not wisely to actually use. It was made purely to give insight in how to configure this particular type of firewall while allowing access to the particular services specified in this report. On the other hand, the configuration is a good start towards a complete configuration.

The testing did not cover the defined firewall rules regarding IP spoofing and malformed TCP headers. They were not tested due to that we followed the \lab{} PM and only run the \texttt{nmap} command to investigate the states of all the ports on the host. Unfortunately, we did not really look through that we had verified all the rules, only that we got the desired output from \texttt{nmap}. If we would have done the lab again the omitted rules would have been tested through other \texttt{nmap} commands. 

If we did test the IP spoofing we would probably see that the defined rules, seen in Listing \ref{lst:fw-config}, were not that good. A later inspection showed that the IP spoofing rules should have been defined in another manner. For the OUTPUT chain the rules on line 31 to 46 are unfortunately designed in such a manner that both the source and the destination addresses has to be invalid in order to be dropped, rather than - as it should be - if only one of the addresses were invalid. The redefinition of the rules on line 31 to 46 are easily performed and can be made by redifining line 57 the final firewall script in appendix \ref{app:fw-final}, as presented in Listing \ref{lst:redef-config}. In the INPUT chain the rules regarding IP spoofing should have been defined in another way as well. As the rules are defined now, the host will accept traffic with any destination address. To only receive traffic addressed to the host, a rule should be inserted on line two to drop packages not destined to the host's IP address.

Many more rules could have been added to the firewall configuration to make it more secure. For example could packets with protected IP addresses been dropped as well as packets with broadcast or TCP multicast IP addresses. Rules regarding blocking different types of unwanted ICMP messages could also been added. There are many more rules that one could have used, but it was not expected of us to come up with a lot of rules just because we could. 

\lstinputlisting[caption=Redefenition of line 57 of the final firewall script in appendix \ref{app:fw-final},label=lst:redef-config]{redef_config.txt}
